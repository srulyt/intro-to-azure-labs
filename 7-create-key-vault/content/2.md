# Exercise 3: Creating & Storing Certificates in Key Vault

In this exercise you will create, store and retrieve a certificate in Azure Key Vault using the Key Vault Certificates capability.

The Certificates feature provides the enhancement over secrets. It provides capability of storing certificates as 'Certificates' objects where Key Vault understands that is a X.509 certificate and provides certain lifecycle monitoring around it, while still making the **private** key available via the **secrets** API. The enhancements are:

- Create the private key of the certificate inside Key Vault to ensure it always has an audit trail.
- Create a certificate manually (by creating a request and getting it signed by a CA), as a self-signed certificate or enroll for a certificate from SSLAdmin.
- Create the private key of the certificate outside Key Vault and import it into Key Vault.
- Auto renew certificate when the certificate reaches 80% of its lifetime

## Task 1: Launch the Azure Management Portal

1. From your browser, navigate to <https://portal.azure.com>, and authenticate with your __Personal Credentials__.

1. Navigate to your Azure Key Vault named `<alias>-contoso-keyvault`

    > **TIP:** You can type the name of the Key Vault into the search box at the top of the Azure portal to quickly navigate to the resource.

## Task 1: Add a certificate to Key Vault

To add a certificate to the vault, you just need to take a couple of additional steps. In this case, we add a self-signed certificate that could be used by an application. The certificate is called `<alias>Certificate`.

1. From the Key Vault's Overview page, select **Certificates**.
1. From the Toolbar, select **Generate/Import**.
1. On the **Create a certificate** screen, choose the following values:
    - **Method of Certificate Creation**: Generate
    - **Certificate Name**: \<alias\>Certificate
    - **Subject**: CN=\<alias\>Domain
    - Leave the other values to their defaults. (By default, if you don't specify anything special in Advanced policy, it'll be usable as a client auth certificate.)
1. Select **Create**.

1. Once that you receive the message that the certificate has been successfully created, **select** it from the list. You can then see some of the properties.

    > **NOTE:** You may have to refresh the listing every few moments until you see the certificate listed under the **Completed** heading.

1. Select the the current version of the certificate and review its properties.

    ![Certificate properties](img/current-version-hiddencert.png)

## Task 3: Export certificate from Key Vault

1. Select "Download in PFX/PEM format" button, to download the certificate.

    ![Certificate download](img/current-version-showncert.png)

    > **NOTE**: While this allows you to export the certificate for use elsewhere, when you download using this option the file may include the **private** key, and the file itself is not password protected. Be mindful of this before downloading a certificate in this manner, so that you don't inadvertently expose the secret by e.g., downloading the file to a network share.

## Summary

In this exercise, you created, stored and retrieved a certificate in Azure Key Vault using the Key Vault Certificates capability.
